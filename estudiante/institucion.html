<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
    <meta charset="utf-8">
    <title>Justin Food App</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/vendor.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/barra.css">
    
    <!-- Favicons (Iconos) -->
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="icon" href="../favicon.ico" type="image/x-icon">
    
</head>

<body>

    <!-- Inicio -->
    <main class="s-home s-home--slides">

        <div class="home-slider">
            <div class="home-slider-img" style="background-image: url(../images/slides/slide-01.jpg);"></div>
            <div class="home-slider-img" style="background-image: url(../images/slides/slide-02.jpg);"></div>
            <div class="home-slider-img" style="background-image: url(../images/slides/slide-03.jpg);"></div>
        </div>

        <div class="overlay"></div>

        <div class="home-content">

            <div class="home-logo">
                <a href="../index.html">
                    <img src="../images/logo.png" alt="JustinFood App">
                </a>
            </div>

            <div class="row home-content__main">

                <div class="col-eight home-content__text pull-right">
                    <h4>Ingresa tu código</h4>

                    <div class="home-content__subscribe">
                        <form id="mc-form" class="group" novalidate="true" onsubmit="return validarCodigo()">
                            <input type="text" value="" name="codigo" class="codigo" id="codigo" placeholder="Código" required="">
                            <input type="submit" name="subscribe" value="Validar">
                            <label for="codigo" class="subscribe-message" id="mensaje"></label>
                        </form>                        
                    </div>
                </div> <!-- end home-content__text -->
            </div> <!-- end home-content -->
        </div>
    </main> <!-- end s-home -->

    <!-- Precargador -->
    <div id="preloader">
        <div id="loader">
            <div class="line-scale-pulse-out">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/plugins.js"></script>
    <script src="../js/main.js"></script>

    <!-- Scripts de códigos -->
    <script src="../js/codigos.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            console.log("DOM completamente cargado y parseado");

            // Verificar si codigosPorPagina está definido
            if (typeof codigosPorPagina !== 'undefined') {
                console.log("codigosPorPagina está definido:", codigosPorPagina);

                // Función para validar el código
                function validarCodigo() {
                    console.log("Función validarCodigo llamada");
                    var codigoIngresado = document.getElementById("codigo").value.toUpperCase();
                    console.log("Código ingresado:", codigoIngresado);
                    var paginaActual = "paginaestudiantes75"; // Cambia esto según la página actual
                    console.log("Página actual:", paginaActual);

                    // Verifica si la página actual tiene un objeto de códigos definido
                    if (codigosPorPagina.hasOwnProperty(paginaActual)) {
                        console.log("Página actual encontrada en codigosPorPagina");
                        var codigosPermitidos = codigosPorPagina[paginaActual];

                        // Verifica si el código ingresado está en la lista de códigos permitidos para esta página
                        if (codigosPermitidos.hasOwnProperty(codigoIngresado)) {
                            console.log("Código válido");
                            // Si el código es válido, redirige al usuario a la página principal
                            window.location.href = "./cetis75/cafeteria.html";
                        } else {
                            console.log("Código inválido");
                            // Si el código es incorrecto, muestra un mensaje de error
                            document.getElementById("mensaje").textContent = "Código incorrecto. Inténtalo de nuevo.";
                        }
                    } else {
                        console.error("No se encontraron códigos para la página actual.");
                    }

                    // Evita que se envíe el formulario
                    return false;
                }

                // Asigna la función validarCodigo al evento onsubmit del formulario
                document.getElementById("mc-form").onsubmit = validarCodigo;
            } else {
                console.error("codigosPorPagina no está definido.");
            }
        });
    </script>

</body>
</html>
